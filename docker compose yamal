# 1️⃣ Revoke any old GCP accounts
gcloud auth revoke --all

# 2️⃣ Login with your desired Gmail account
gcloud auth login

# 3️⃣ Set the correct project
gcloud config set project oauthtest-449810

# 4️⃣ Configure Docker to use GCP credentials for Artifact Registry
gcloud auth configure-docker us-central1-docker.pkg.dev

# 5️⃣ (Optional) Logout old Docker credentials
docker logout https://us-central1-docker.pkg.dev

# 6️⃣ Login Docker using gcloud token (automatic token refresh)
gcloud auth print-access-token | docker login -u oauth2accesstoken --password-stdin https://us-central1-docker.pkg.dev

# 7️⃣ Build your Docker image (if not built yet)
docker build -t us-central1-docker.pkg.dev/oauthtest-449810/react-repo/react-gcp:latest .

# 8️⃣ Push the Docker image
docker push us-central1-docker.pkg.dev/oauthtest-449810/react-repo/react-gcp:latest
